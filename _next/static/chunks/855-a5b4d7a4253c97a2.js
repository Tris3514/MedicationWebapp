"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[855],{216:(e,r,t)=>{t.d(r,{VR:()=>n,gL:()=>s,oN:()=>d,y_:()=>i});let a={};function o(e){return"".concat("user_data_").concat(e)}function s(e){let r=o(e),t=localStorage.getItem(r);if(!t)return n();try{return JSON.parse(t)}catch(e){return console.error("Error parsing user data:",e),n()}}function l(e,r){let t=o(e);try{localStorage.setItem(t,JSON.stringify(r))}catch(e){console.error("Error saving user data:",e)}}function i(e,r){a[e]&&(clearTimeout(a[e]),delete a[e]),l(e,r)}function n(){return{flightCount:0,trackedFlightIds:[],weatherLocations:[],savedBusinesses:[],blacklistedBusinesses:[],medications:[],lastCheckDate:null,networkSpeedTest:null,dashboardCards:[],theme:null}}function d(e){let r=n(),t=localStorage.getItem("totalFlightsTracked");t&&(r.flightCount=parseInt(t,10)||0,localStorage.removeItem("totalFlightsTracked"));let a=localStorage.getItem("trackedFlightIds");if(a)try{r.trackedFlightIds=JSON.parse(a),localStorage.removeItem("trackedFlightIds")}catch(e){console.error("Error parsing tracked flight IDs:",e)}let o=localStorage.getItem("weather-tracker-data");if(o)try{r.weatherLocations=JSON.parse(o).locations||[],localStorage.removeItem("weather-tracker-data")}catch(e){console.error("Error parsing weather data:",e)}let s=localStorage.getItem("saved-businesses");if(s)try{r.savedBusinesses=JSON.parse(s),localStorage.removeItem("saved-businesses")}catch(e){console.error("Error parsing saved businesses:",e)}let i=localStorage.getItem("blacklisted-businesses");if(i)try{r.blacklistedBusinesses=JSON.parse(i),localStorage.removeItem("blacklisted-businesses")}catch(e){console.error("Error parsing blacklisted businesses:",e)}let d=localStorage.getItem("medication-tracker-data");if(d)try{r.medications=JSON.parse(d)||[],localStorage.removeItem("medication-tracker-data")}catch(e){console.error("Error parsing medication data:",e)}let u=localStorage.getItem("last-check-date");u&&(r.lastCheckDate=u,localStorage.removeItem("last-check-date"));let c=localStorage.getItem("network-speed-test");if(c)try{r.networkSpeedTest=JSON.parse(c),localStorage.removeItem("network-speed-test")}catch(e){console.error("Error parsing network speed data:",e)}return l(e,r),r}},2805:(e,r,t)=>{t.d(r,{E:()=>d,UserDataProvider:()=>n});var a=t(5155),o=t(2115),s=t(5380),l=t(216);let i=(0,o.createContext)(void 0);function n(e){let{children:r}=e,{user:t,isAuthenticated:n}=(0,s.A)(),[d,u]=(0,o.useState)(null),[c,g]=(0,o.useState)(!1),m=(0,o.useCallback)(async()=>{if(!n||!(null==t?void 0:t.id))return void u(null);g(!0);try{console.log("Loading user data for user:",t.id);let e=(0,l.gL)(t.id);u(e),console.log("Loaded user data:",e)}catch(e){console.error("Failed to load user data:",e),u((0,l.VR)())}finally{g(!1)}},[n,null==t?void 0:t.id]),h=(0,o.useCallback)(()=>{console.log("Resetting user data to defaults"),u(null)},[]),v=(0,o.useCallback)((e,r)=>{if(!n||!(null==t?void 0:t.id)||!d)return void console.warn("Cannot update data: user not authenticated or data not loaded");let a={...d,[e]:r};u(a),console.log("Updating ".concat(e,":"),r),(0,l.y_)(t.id,a)},[n,null==t?void 0:t.id,d]),f=(0,o.useCallback)(e=>{if(!n||!(null==t?void 0:t.id)||!d)return void console.warn("Cannot update data: user not authenticated or data not loaded");let r={...d,...e};u(r),console.log("Updating multiple data fields:",e),(0,l.y_)(t.id,r)},[n,null==t?void 0:t.id,d]),S=(0,o.useCallback)(e=>d&&d[e]||null,[d]),k=(0,o.useCallback)(()=>{if(!n||!(null==t?void 0:t.id)||!d)return void console.warn("Cannot save data: user not authenticated or data not loaded");console.log("Force saving user data:",d),(0,l.y_)(t.id,d)},[n,null==t?void 0:t.id,d]);return(0,o.useEffect)(()=>{n?m():h()},[n,m,h]),(0,a.jsx)(i.Provider,{value:{userData:d,isLoading:c,updateData:v,updateMultipleData:f,getData:S,saveData:k,resetToDefaults:h},children:r})}function d(){let e=(0,o.useContext)(i);if(void 0===e)throw Error("useUserDataContext must be used within a UserDataProvider");return e}},3479:(e,r,t)=>{t.d(r,{D:()=>l,ThemeProvider:()=>i});var a=t(5155),o=t(2115);let s=(0,o.createContext)(void 0);function l(){let e=(0,o.useContext)(s);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}function i(e){let{children:r,defaultTheme:t="dark"}=e,[l,i]=(0,o.useState)(t);return(0,o.useEffect)(()=>{let e=localStorage.getItem("theme");e&&("dark"===e||"light"===e)&&i(e)},[]),(0,o.useEffect)(()=>{let e=window.document.documentElement;e.classList.remove("light","dark"),e.classList.add(l),localStorage.setItem("theme",l)},[l]),(0,a.jsx)(s.Provider,{value:{theme:l,setTheme:i,toggleTheme:()=>{i("dark"===l?"light":"dark")}},children:r})}},5380:(e,r,t)=>{t.d(r,{A:()=>n,AuthProvider:()=>i});var a=t(5155),o=t(2115),s=t(216);let l=(0,o.createContext)(void 0);function i(e){let{children:r}=e,[t,i]=(0,o.useState)({user:null,isAuthenticated:!1,isLoading:!0,error:null});(0,o.useEffect)(()=>{try{let e=localStorage.getItem("user_data");if(e){let r=JSON.parse(e);i({user:r,isAuthenticated:!0,isLoading:!1,error:null})}else i({user:null,isAuthenticated:!1,isLoading:!1,error:null})}catch(e){console.error("Auth check failed:",e),localStorage.removeItem("user_data"),i({user:null,isAuthenticated:!1,isLoading:!1,error:"Failed to load user data"})}},[]);let n=async e=>{i(e=>({...e,isLoading:!0,error:null}));try{let r=JSON.parse(localStorage.getItem("users")||"[]"),t=r.find(r=>r.email===e.email&&r.password===e.password);if(!t)return i(e=>({...e,isLoading:!1,error:"Invalid email or password"})),{success:!1,error:"Invalid email or password"};{let e={...t,lastLoginAt:new Date().toISOString()},a=r.map(r=>r.email===t.email?e:r);return localStorage.setItem("users",JSON.stringify(a)),localStorage.setItem("user_data",JSON.stringify(e)),i({user:e,isAuthenticated:!0,isLoading:!1,error:null}),(0,s.oN)(e.id),{success:!0,user:e}}}catch(r){let e="Login failed. Please try again.";return i(r=>({...r,isLoading:!1,error:e})),{success:!1,error:e}}},d=async e=>{i(e=>({...e,isLoading:!0,error:null}));try{let r=JSON.parse(localStorage.getItem("users")||"[]");if(r.find(r=>r.email===e.email))return i(e=>({...e,isLoading:!1,error:"User with this email already exists"})),{success:!1,error:"User with this email already exists"};let t={id:Date.now().toString(),name:e.name,email:e.email,password:e.password,createdAt:new Date().toISOString(),lastLoginAt:new Date().toISOString()},a=[...r,t];return localStorage.setItem("users",JSON.stringify(a)),localStorage.setItem("user_data",JSON.stringify(t)),i({user:t,isAuthenticated:!0,isLoading:!1,error:null}),(0,s.oN)(t.id),{success:!0,user:t}}catch(r){let e="Sign up failed. Please try again.";return i(r=>({...r,isLoading:!1,error:e})),{success:!1,error:e}}},u={...t,login:n,signUp:d,logout:()=>{var e;if(null==(e=t.user)?void 0:e.id){let e=(0,s.gL)(t.user.id);(0,s.y_)(t.user.id,e),console.log("User logged out, data preserved for future login")}localStorage.removeItem("user_data"),i({user:null,isAuthenticated:!1,isLoading:!1,error:null})},clearError:()=>{i(e=>({...e,error:null}))},loadUserData:()=>{var e;(null==(e=t.user)?void 0:e.id)&&(0,s.oN)(t.user.id)},saveCurrentUserData:()=>{var e;null==(e=t.user)||e.id}};return(0,a.jsx)(l.Provider,{value:u,children:r})}function n(){let e=(0,o.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}}]);